(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{36:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},68:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(46),r=n.n(s),i=(n(59),n(7)),o=(n(60),n(21)),l=n(6),u=(n(61),n(12)),d=n.n(u),j=n(16),m=n(47),p=n.n(m),O=(n(63),n(17)),f={apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_KEY,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).AUTH_DOMAIN,projectId:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).PROJECT_ID,storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).STORAGE_BASKET,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).MESSAGE_SENDER_ID,appId:Object({NODE_ENV:"production",PUBLIC_URL:"/watsapp_clone",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).APP_ID},h=O.a.initializeApp(f),b=O.a.auth(),x=h.firestore(),v=new O.a.auth.GoogleAuthProvider,g=x,S=(n(68),n(3));var _=function(e){var t=e.name,n=e.photoURL,c=e.email,s=e.lastMessage,r=e.timeStamp,o=Object(l.f)(),u=new Date(null===r||void 0===r?void 0:r.toDate()).toLocaleTimeString(),m=Object(a.useState)([]),p=Object(i.a)(m,2),O=p[0],f=p[1],h=Object(l.g)().emailID,b=Object(a.useState)({}),x=Object(i.a)(b,2),v=x[0],_=x[1];console.log(c,"userProfile"),console.log(O,"userProfile"),Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("users").doc(c).onSnapshot((function(e){_(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("chats").doc(c).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(c||h)||e.receiverEmail===(c||h)}));f(t.filter((function(e){return!e.isRead&&(c||h)===e.senderEmail})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t()}),[]),Object(a.useEffect)((function(){(function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("users").doc(c).onSnapshot((function(e){_(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]),console.log(O);var E=O.filter((function(e){return!1===e.isRead}));return Object(S.jsxs)("div",{className:"user-profile",onClick:function(){var e;g.collection("chats").doc(h).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))})),(e=c)&&o("/".concat(e))},children:[O.length>0&&Object(S.jsx)("div",{className:"unread_message",children:E.length}),Object(S.jsxs)("div",{className:"user-image",children:[Object(S.jsx)("img",{src:n,alt:""}),v.online&&Object(S.jsx)("div",{className:"user-active"})]}),Object(S.jsxs)("div",{className:"user-info",children:[Object(S.jsxs)("span",{className:"last_time",children:[" ",u," "]}),Object(S.jsx)("p",{className:"user-name",children:t}),s&&Object(S.jsx)("p",{className:"user-lastmessage",children:s})]})]})};var E=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),u=Object(i.a)(l,2),m=u[0],O=u[1],f=Object(a.useState)([]),h=Object(i.a)(f,2),b=h[0],x=h[1];Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("users").onSnapshot((function(e){o(e.docs.filter((function(e){return e.data().email})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("Friendlist").doc(t.email).collection("list").onSnapshot((function(e){x(e.docs)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[]);var v=r.filter((function(e){if(m&&e.data().fullname.toLowerCase().includes(m.toLowerCase()))return e})).map((function(e){return Object(S.jsx)(_,{name:e.data().fullname,photoURL:e.data().photoURL,email:e.data().email},e.id)}));return Object(S.jsxs)("div",{className:"sidebar",children:[Object(S.jsxs)("div",{className:"sidebar-header",children:[Object(S.jsxs)("div",{className:"sidebar-header-btn",onClick:n,children:[Object(S.jsx)("div",{className:"burger_item"}),Object(S.jsx)("div",{className:"burger_item middle"}),Object(S.jsx)("div",{className:"burger_item"})]}),Object(S.jsx)("h1",{className:"h1",children:"TrueChat"}),Object(S.jsx)("div",{className:"sidebar-header-img",children:Object(S.jsx)("img",{src:null===t||void 0===t?void 0:t.photoURL,alt:""})})]}),Object(S.jsx)("div",{className:"sidebar-search",children:Object(S.jsxs)("div",{className:"sidebar-search-input",children:[Object(S.jsx)(p.a,{}),Object(S.jsx)("input",{type:"text",name:"search",placeholder:"Search...",value:m,onChange:function(e){return O(e.target.value)}})]})}),Object(S.jsx)("div",{className:"sidebar-chat-list",children:v.length>0?v:b.map((function(e){return Object(S.jsx)(_,{name:e.data().fullname,photoURL:e.data().photoURL,lastMessage:e.data().lastMessage,email:e.data().email,timeStamp:e.data().timeStamp})}))})]})};var N=function(e){var t=e.currentUser,n=e.signOut;return Object(S.jsx)("div",{className:"home",children:Object(S.jsxs)("div",{className:"home-container",children:[Object(S.jsx)(E,{currentUser:t,signOut:n}),Object(S.jsx)("div",{className:"home-bg",children:Object(S.jsx)("img",{src:"./WhatsAppbg.png",alt:""})})]})})},T=(n(36),n(34)),R=n.n(T),U=n(50),w=n.n(U),C=n(52),D=n.n(C),L=n(51),P=n.n(L),I=n(53),y=n.n(I),A=n(33),F=n.n(A);n(92);var k=function(e){var t=e.message,n=e.time,c=e.sender,s=e.translateFlag,r=e.chatUser,o=e.currentUser,u=e.messageFull,d=Object(a.useState)(t),j=Object(i.a)(d,2),m=j[0],p=j[1],O=(Object(l.g)().emailID,o.email===c),f=O?o.photoURL:r;return console.log(u),Object(a.useEffect)((function(){if(null!==s){var e=new URLSearchParams;e.append("q",m),e.append("source",s?"en":"ru"),e.append("target",s?"ru":"en"),e.append("api_key","xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"),F.a.post("https://libretranslate.de/translate",e,{headers:{accept:"application.json","Content-type":"application/x-www-form-urlencoded"}}).then((function(e){p(e.data.translatedText)}))}}),[s]),Object(S.jsxs)("div",{className:"chat-message",style:{alignSelf:O?"flex-end":"flex-start",alignItems:"left",backgroundColor:O?"rgb(64, 245, 101)":"#fff"},children:[Object(S.jsx)("img",{src:f,alt:"user",className:"img",style:{left:!O&&"-20px",right:O&&"-20px",top:"-18px"}}),Object(S.jsx)("div",{className:"chat-message-text",style:{color:O&&"#fff"},children:Object(S.jsx)("p",{children:m})}),Object(S.jsx)("div",{className:"chat-message-date",children:Object(S.jsx)("p",{children:new Date(n.toDate()).toLocaleTimeString()})})]})},K=n(49),W=n.n(K);var H=function(e){var t=e.currentUser,n=(e.setUnreadMessages,Object(a.useState)("")),c=Object(i.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(!1),u=Object(i.a)(o,2),m=u[0],p=u[1],f=Object(l.g)().emailID,h=Object(a.useState)({}),b=Object(i.a)(h,2),x=b[0],v=b[1],_=Object(a.useRef)(null),E=Object(a.useState)([]),N=Object(i.a)(E,2),T=N[0],U=N[1],C=Object(a.useState)(null),L=Object(i.a)(C,2),I=L[0],A=L[1];Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("users").doc(f).onSnapshot((function(e){v(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("chats").doc(f).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var n=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(t.email||f)||e.receiverEmail===(t.email||f)}));U(n)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[f]),Object(a.useEffect)((function(){_.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})}))}),[T]);var F=function(){var e=Object(j.a)(d.a.mark((function e(n){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),f&&(a={text:s,senderEmail:t.email,receiverEmail:f,timeStamp:O.a.firestore.Timestamp.now(),isRead:!1},c={text:s,senderEmail:t.email,receiverEmail:f,timeStamp:O.a.firestore.Timestamp.now(),isRead:!1},g.collection("chats").doc(t.email).collection("messages").add(a),g.collection("chats").doc(f).collection("messages").add(c),g.collection("Friendlist").doc(t.email).collection("list").doc(f).set({email:x.email,fullname:x.fullname,photoURL:x.photoURL,lastMessage:s,timeStamp:O.a.firestore.Timestamp.now()}),g.collection("Friendlist").doc(f).collection("list").doc(t.email).set({email:t.email,fullname:t.fullname,photoURL:t.photoURL,lastMessage:s,timeStamp:O.a.firestore.Timestamp.now()}),r(""));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){g.collection("chats").doc(f).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))}))}),[f,T]),Object(S.jsxs)("div",{className:"chat-container",children:[Object(S.jsxs)("div",{className:"chat-container-header",children:[Object(S.jsxs)("div",{className:"chat-user-info",children:[Object(S.jsx)("p",{children:null===x||void 0===x?void 0:x.fullname}),x.online&&Object(S.jsx)("span",{children:"Active now"}),x.online&&Object(S.jsx)("div",{className:"active"})]}),Object(S.jsx)("div",{className:"chat-container-header-btn",children:Object(S.jsx)(R.a,{})})]}),Object(S.jsx)("div",{className:"chat-display-container",ref:_,children:T.map((function(e){return Object(S.jsx)(k,{message:e.text,time:e.timeStamp,sender:e.senderEmail,translateFlag:I,chatUser:x.photoURL,currentUser:t,messageFull:e})}))}),Object(S.jsxs)("div",{className:"chat-input",children:[m&&Object(S.jsx)(W.a,{onEmojiClick:function(e,t){return r(s+t.emoji)}}),Object(S.jsxs)("div",{className:"chat-input-btn",children:[Object(S.jsx)(w.a,{onClick:function(){return p(!m)}}),Object(S.jsx)(P.a,{}),Object(S.jsx)(D.a,{})]}),Object(S.jsx)("form",{onSubmit:F,children:Object(S.jsx)("input",{type:"text",placeholder:"Type a Message",value:s,onChange:function(e){r(e.target.value)}})}),Object(S.jsx)("div",{className:"select",children:Object(S.jsxs)("span",{onClick:function(){return A(null===I||!0===I&&!1||!1===I&&!0)},children:["Translate to ",I?"en":"ru"]})}),Object(S.jsx)("div",{className:"chat-input-send-btn",onClick:F,children:Object(S.jsx)(y.a,{})})]})]})};n(93);var B=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)(2),s=Object(i.a)(c,2),r=s[0],o=s[1];return Object(S.jsx)("div",{className:"chatpage",children:Object(S.jsxs)("div",{className:"chatpage-container",children:[Object(S.jsx)(E,{currentUser:t,signOut:n,unreadMessages:r}),Object(S.jsx)(H,{currentUser:t,setUnreadMessages:o})]})})};n(94);var M=function(e){var t=e.setUser,n=Object(l.f)();return Object(S.jsx)("div",{className:"login",children:Object(S.jsxs)("div",{className:"login-container",children:[Object(S.jsx)("img",{className:"login-logo",src:"./whatsapp-logo.png",alt:""}),Object(S.jsx)("h2",{className:"login_h2",children:"Welcome Back"}),Object(S.jsx)("p",{className:"login_p",children:" To keep connected with us please login with you personal info"}),Object(S.jsx)("button",{className:"login-btn",onClick:function(){b.signInWithPopup(v).then((function(e){var a={fullname:e.user.displayName,email:e.user.email,photoURL:e.user.photoURL,online:!0};n("/"),t(a),localStorage.setItem("user",JSON.stringify(a)),g.collection("users").doc(e.user.email).set(a)})).catch((function(e){return alert(e.message)}))},children:"SIGN IN"})]})})};var V=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("user"))),t=Object(i.a)(e,2),n=t[0],c=t[1],s=function(){b.signOut().then((function(){c(null),localStorage.removeItem("user"),g.collection("users").doc(n.email).set({email:n.email,fullname:n.fullname,photoURL:n.photoURL,online:!1})})).catch((function(e){return alert(e.message)}))};return Object(S.jsx)(o.a,{children:Object(S.jsx)("div",{className:"App",children:n?Object(S.jsxs)(l.c,{children:[Object(S.jsx)(l.a,{path:"/:emailID",element:Object(S.jsx)(B,{currentUser:n,signOut:s})}),Object(S.jsx)(l.a,{path:"/",element:Object(S.jsx)(N,{currentUser:n,signOut:s})})]}):Object(S.jsx)(M,{setUser:c})})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(V,{})}),document.getElementById("root")),J()}},[[96,1,2]]]);
//# sourceMappingURL=main.c035b7c4.chunk.js.map