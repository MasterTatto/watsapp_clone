(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{36:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},68:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(46),r=n.n(s),i=(n(59),n(7)),o=(n(60),n(6)),l=(n(61),n(12)),u=n.n(l),d=n(16),j=n(47),m=n.n(j),f=(n(63),n(17)),h=f.a.initializeApp({apiKey:"AIzaSyDVq-cKoKNt1EHQxJ2MnxZzQIjKtnrLUW8",authDomain:"chatimg-730ba.firebaseapp.com",projectId:"chatimg-730ba",storageBucket:"chatimg-730ba.appspot.com",messagingSenderId:"185994771045",appId:"1:185994771045:web:e2c99c64d3dfbbe563a48c"}),p=f.a.auth(),b=h.firestore(),x=new f.a.auth.GoogleAuthProvider,O=b,v=(n(68),n(3));var g=function(e){var t=e.name,n=e.photoURL,c=e.email,s=e.lastMessage,r=e.timeStamp,l=Object(o.f)(),j=new Date(null===r||void 0===r?void 0:r.toDate()).toLocaleTimeString(),m=Object(a.useState)([]),f=Object(i.a)(m,2),h=f[0],p=f[1],b=Object(o.g)().emailID,x=Object(a.useState)({}),g=Object(i.a)(x,2),N=g[0],S=g[1];console.log(c,"userProfile"),console.log(h,"userProfile"),Object(a.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("users").doc(c).onSnapshot((function(e){S(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("chats").doc(c).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(c||b)||e.receiverEmail===(c||b)}));p(t.filter((function(e){return!e.isRead&&(c||b)===e.senderEmail})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t()}),[]),Object(a.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("users").doc(c).onSnapshot((function(e){S(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]),console.log(h);var w=h.filter((function(e){return!1===e.isRead}));return Object(v.jsxs)("div",{className:"user-profile",onClick:function(){var e;O.collection("chats").doc(b).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))})),(e=c)&&l("/".concat(e))},children:[h.length>0&&Object(v.jsx)("div",{className:"unread_message",children:w.length}),Object(v.jsxs)("div",{className:"user-image",children:[Object(v.jsx)("img",{src:n,alt:""}),(null===N||void 0===N?void 0:N.online)&&Object(v.jsx)("div",{className:"user-active"})]}),Object(v.jsxs)("div",{className:"user-info",children:[Object(v.jsxs)("span",{className:"last_time",children:[" ",j," "]}),Object(v.jsx)("p",{className:"user-name",children:t}),s&&Object(v.jsx)("p",{className:"user-lastmessage",children:s})]})]})};var N=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),j=Object(i.a)(l,2),f=j[0],h=j[1],p=Object(a.useState)([]),b=Object(i.a)(p,2),x=b[0],N=b[1];Object(a.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("users").onSnapshot((function(e){o(e.docs.filter((function(e){return e.data().email})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("Friendlist").doc(t.email).collection("list").onSnapshot((function(e){N(e.docs)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[]);var S=r.filter((function(e){if(f&&e.data().fullname.toLowerCase().includes(f.toLowerCase()))return e})).map((function(e){return Object(v.jsx)(g,{name:e.data().fullname,photoURL:e.data().photoURL,email:e.data().email},e.id)}));return Object(v.jsxs)("div",{className:"sidebar",children:[Object(v.jsxs)("div",{className:"sidebar-header",children:[Object(v.jsxs)("div",{className:"sidebar-header-btn",onClick:n,children:[Object(v.jsx)("div",{className:"burger_item"}),Object(v.jsx)("div",{className:"burger_item middle"}),Object(v.jsx)("div",{className:"burger_item"})]}),Object(v.jsx)("h1",{className:"h1",children:"TrueChat"}),Object(v.jsx)("div",{className:"sidebar-header-img",children:Object(v.jsx)("img",{src:null===t||void 0===t?void 0:t.photoURL,alt:""})})]}),Object(v.jsx)("div",{className:"sidebar-search",children:Object(v.jsxs)("div",{className:"sidebar-search-input",children:[Object(v.jsx)(m.a,{}),Object(v.jsx)("input",{type:"text",name:"search",placeholder:"Search...",value:f,onChange:function(e){return h(e.target.value)}})]})}),Object(v.jsx)("div",{className:"sidebar-chat-list",children:S.length>0?S:x.map((function(e){return Object(v.jsx)(g,{name:e.data().fullname,photoURL:e.data().photoURL,lastMessage:e.data().lastMessage,email:e.data().email,timeStamp:e.data().timeStamp})}))})]})};var S=function(e){var t=e.currentUser,n=e.signOut;return Object(v.jsx)("div",{className:"home",children:Object(v.jsxs)("div",{className:"home-container",children:[Object(v.jsx)(N,{currentUser:t,signOut:n}),Object(v.jsx)("div",{className:"home-bg",children:Object(v.jsx)("img",{src:"./WhatsAppbg.png",alt:""})})]})})},w=(n(36),n(34)),U=n.n(w),y=n(50),L=n.n(y),R=n(52),E=n.n(R),k=n(51),I=n.n(k),C=n(53),T=n.n(C),D=n(33),M=n.n(D);n(92);var F=function(e){var t=e.message,n=e.time,c=e.sender,s=e.translateFlag,r=e.chatUser,l=e.currentUser,u=e.messageFull,d=Object(a.useState)(t),j=Object(i.a)(d,2),m=j[0],f=j[1],h=(Object(o.g)().emailID,l.email===c),p=h?l.photoURL:r;return console.log(u),Object(a.useEffect)((function(){if(null!==s){var e=new URLSearchParams;e.append("q",m),e.append("source",s?"en":"ru"),e.append("target",s?"ru":"en"),e.append("api_key","xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"),M.a.post("https://libretranslate.de/translate",e,{headers:{accept:"application.json","Content-type":"application/x-www-form-urlencoded"}}).then((function(e){f(e.data.translatedText)}))}}),[s]),Object(v.jsxs)("div",{className:"chat-message",style:{alignSelf:h?"flex-end":"flex-start",alignItems:"left",backgroundColor:h?"rgb(64, 245, 101)":"#fff"},children:[Object(v.jsx)("img",{src:p,alt:"user",className:"img",style:{left:!h&&"-20px",right:h&&"-20px",top:"-18px"}}),Object(v.jsx)("div",{className:"chat-message-text",style:{color:h&&"#fff"},children:Object(v.jsx)("p",{children:m})}),Object(v.jsx)("div",{className:"chat-message-date",children:Object(v.jsx)("p",{children:new Date(n.toDate()).toLocaleTimeString()})})]})},_=n(49),P=n.n(_);var A=function(e){var t=e.currentUser,n=(e.setUnreadMessages,Object(a.useState)("")),c=Object(i.a)(n,2),s=c[0],r=c[1],l=Object(a.useState)(!1),j=Object(i.a)(l,2),m=j[0],h=j[1],p=Object(o.g)().emailID,b=Object(a.useState)({}),x=Object(i.a)(b,2),g=x[0],N=x[1],S=Object(a.useRef)(null),w=Object(a.useState)([]),y=Object(i.a)(w,2),R=y[0],k=y[1],C=Object(a.useState)(null),D=Object(i.a)(C,2),M=D[0],_=D[1];Object(a.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("users").doc(p).onSnapshot((function(e){N(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.collection("chats").doc(p).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var n=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(t.email||p)||e.receiverEmail===(t.email||p)}));k(n)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[p]),Object(a.useEffect)((function(){S.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})}))}),[R]);var A=function(){var e=Object(d.a)(u.a.mark((function e(n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),p&&(a={text:s,senderEmail:t.email,receiverEmail:p,timeStamp:f.a.firestore.Timestamp.now(),isRead:!1},c={text:s,senderEmail:t.email,receiverEmail:p,timeStamp:f.a.firestore.Timestamp.now(),isRead:!1},O.collection("chats").doc(t.email).collection("messages").add(a),O.collection("chats").doc(p).collection("messages").add(c),O.collection("Friendlist").doc(t.email).collection("list").doc(p).set({email:g.email,fullname:g.fullname,photoURL:g.photoURL,lastMessage:s,timeStamp:f.a.firestore.Timestamp.now()}),O.collection("Friendlist").doc(p).collection("list").doc(t.email).set({email:t.email,fullname:t.fullname,photoURL:t.photoURL,lastMessage:s,timeStamp:f.a.firestore.Timestamp.now()}),r(""));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){O.collection("chats").doc(p).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))}))}),[p,R]),Object(v.jsxs)("div",{className:"chat-container",children:[Object(v.jsxs)("div",{className:"chat-container-header",children:[Object(v.jsxs)("div",{className:"chat-user-info",children:[Object(v.jsx)("p",{children:null===g||void 0===g?void 0:g.fullname}),(null===g||void 0===g?void 0:g.online)&&Object(v.jsx)("span",{children:"Active now"}),(null===g||void 0===g?void 0:g.online)&&Object(v.jsx)("div",{className:"active"})]}),Object(v.jsx)("div",{className:"chat-container-header-btn",children:Object(v.jsx)(U.a,{})})]}),Object(v.jsx)("div",{className:"chat-display-container",ref:S,children:R.map((function(e){return Object(v.jsx)(F,{message:e.text,time:e.timeStamp,sender:e.senderEmail,translateFlag:M,chatUser:g.photoURL,currentUser:t,messageFull:e})}))}),Object(v.jsxs)("div",{className:"chat-input",children:[m&&Object(v.jsx)(P.a,{onEmojiClick:function(e,t){return r(s+t.emoji)}}),Object(v.jsxs)("div",{className:"chat-input-btn",children:[Object(v.jsx)(L.a,{onClick:function(){return h(!m)}}),Object(v.jsx)(I.a,{}),Object(v.jsx)(E.a,{})]}),Object(v.jsx)("form",{onSubmit:A,children:Object(v.jsx)("input",{type:"text",placeholder:"Type a Message",value:s,onChange:function(e){r(e.target.value)}})}),Object(v.jsx)("div",{className:"select",children:Object(v.jsxs)("span",{onClick:function(){return _(null===M||!0===M&&!1||!1===M&&!0)},children:["Translate to ",M?"en":"ru"]})}),Object(v.jsx)("div",{className:"chat-input-send-btn",onClick:A,children:Object(v.jsx)(T.a,{})})]})]})};n(93);var B=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)(2),s=Object(i.a)(c,2),r=s[0],o=s[1];return Object(v.jsx)("div",{className:"chatpage",children:Object(v.jsxs)("div",{className:"chatpage-container",children:[Object(v.jsx)(N,{currentUser:t,signOut:n,unreadMessages:r}),Object(v.jsx)(A,{currentUser:t,setUnreadMessages:o})]})})};n(94);var J=function(e){var t=e.setUser,n=Object(o.f)();return Object(v.jsx)("div",{className:"login",children:Object(v.jsxs)("div",{className:"login-container",children:[Object(v.jsx)("img",{className:"login-logo",src:"./whatsapp-logo.png",alt:""}),Object(v.jsx)("h2",{className:"login_h2",children:"Welcome Back"}),Object(v.jsx)("p",{className:"login_p",children:" To keep connected with us please login with you personal info"}),Object(v.jsx)("button",{className:"login-btn",onClick:function(){p.signInWithPopup(x).then((function(e){var a={fullname:e.user.displayName,email:e.user.email,photoURL:e.user.photoURL,online:!0};n("/"),t(a),localStorage.setItem("user",JSON.stringify(a)),O.collection("users").doc(e.user.email).set(a)})).catch((function(e){return alert(e.message)}))},children:"SIGN IN"})]})})};var K=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("user"))),t=Object(i.a)(e,2),n=t[0],c=t[1],s=function(){p.signOut().then((function(){c(null),localStorage.removeItem("user"),O.collection("users").doc(n.email).set({email:n.email,fullname:n.fullname,photoURL:n.photoURL,online:!1})})).catch((function(e){return alert(e.message)}))};return Object(v.jsx)("div",{className:"App",children:n?Object(v.jsxs)(o.c,{children:[Object(v.jsx)(o.a,{path:"/:emailID",element:Object(v.jsx)(B,{currentUser:n,signOut:s})}),Object(v.jsx)(o.a,{path:"/",element:Object(v.jsx)(S,{currentUser:n,signOut:s})})]}):Object(v.jsx)(J,{setUser:c})})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))},z=n(19);r.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(z.a,{children:Object(v.jsx)(K,{})})}),document.getElementById("root")),W()}},[[96,1,2]]]);
//# sourceMappingURL=main.dcc0fe91.chunk.js.map