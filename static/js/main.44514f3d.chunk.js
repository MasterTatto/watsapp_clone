(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{36:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},68:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),s=n(46),r=n.n(s),i=(n(59),n(7)),o=(n(60),n(21)),l=n(6),u=(n(61),n(12)),d=n.n(u),j=n(16),m=n(47),f=n.n(m),h=(n(63),n(17)),p=h.a.initializeApp({apiKey:"AIzaSyDVq-cKoKNt1EHQxJ2MnxZzQIjKtnrLUW8",authDomain:"chatimg-730ba.firebaseapp.com",projectId:"chatimg-730ba",storageBucket:"chatimg-730ba.appspot.com",messagingSenderId:"185994771045",appId:"1:185994771045:web:e2c99c64d3dfbbe563a48c"}),b=h.a.auth(),x=p.firestore(),O=new h.a.auth.GoogleAuthProvider,v=x,g=(n(68),n(3));var N=function(e){var t=e.name,n=e.photoURL,c=e.email,s=e.lastMessage,r=e.timeStamp,o=Object(l.f)(),u=new Date(null===r||void 0===r?void 0:r.toDate()).toLocaleTimeString(),m=Object(a.useState)([]),f=Object(i.a)(m,2),h=f[0],p=f[1],b=Object(l.g)().emailID,x=Object(a.useState)({}),O=Object(i.a)(x,2),N=O[0],S=O[1];console.log(c,"userProfile"),console.log(h,"userProfile"),Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("users").doc(c).onSnapshot((function(e){S(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("chats").doc(c).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(c||b)||e.receiverEmail===(c||b)}));p(t.filter((function(e){return!e.isRead&&(c||b)===e.senderEmail})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t()}),[]),Object(a.useEffect)((function(){(function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("users").doc(c).onSnapshot((function(e){S(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]),console.log(h);var w=h.filter((function(e){return!1===e.isRead}));return Object(g.jsxs)("div",{className:"user-profile",onClick:function(){var e;v.collection("chats").doc(b).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))})),(e=c)&&o("/".concat(e))},children:[h.length>0&&Object(g.jsx)("div",{className:"unread_message",children:w.length}),Object(g.jsxs)("div",{className:"user-image",children:[Object(g.jsx)("img",{src:n,alt:""}),(null===N||void 0===N?void 0:N.online)&&Object(g.jsx)("div",{className:"user-active"})]}),Object(g.jsxs)("div",{className:"user-info",children:[Object(g.jsxs)("span",{className:"last_time",children:[" ",u," "]}),Object(g.jsx)("p",{className:"user-name",children:t}),s&&Object(g.jsx)("p",{className:"user-lastmessage",children:s})]})]})};var S=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),u=Object(i.a)(l,2),m=u[0],h=u[1],p=Object(a.useState)([]),b=Object(i.a)(p,2),x=b[0],O=b[1];Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("users").onSnapshot((function(e){o(e.docs.filter((function(e){return e.data().email})))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("Friendlist").doc(t.email).collection("list").onSnapshot((function(e){O(e.docs)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[]);var S=r.filter((function(e){if(m&&e.data().fullname.toLowerCase().includes(m.toLowerCase()))return e})).map((function(e){return Object(g.jsx)(N,{name:e.data().fullname,photoURL:e.data().photoURL,email:e.data().email},e.id)}));return Object(g.jsxs)("div",{className:"sidebar",children:[Object(g.jsxs)("div",{className:"sidebar-header",children:[Object(g.jsxs)("div",{className:"sidebar-header-btn",onClick:n,children:[Object(g.jsx)("div",{className:"burger_item"}),Object(g.jsx)("div",{className:"burger_item middle"}),Object(g.jsx)("div",{className:"burger_item"})]}),Object(g.jsx)("h1",{className:"h1",children:"TrueChat"}),Object(g.jsx)("div",{className:"sidebar-header-img",children:Object(g.jsx)("img",{src:null===t||void 0===t?void 0:t.photoURL,alt:""})})]}),Object(g.jsx)("div",{className:"sidebar-search",children:Object(g.jsxs)("div",{className:"sidebar-search-input",children:[Object(g.jsx)(f.a,{}),Object(g.jsx)("input",{type:"text",name:"search",placeholder:"Search...",value:m,onChange:function(e){return h(e.target.value)}})]})}),Object(g.jsx)("div",{className:"sidebar-chat-list",children:S.length>0?S:x.map((function(e){return Object(g.jsx)(N,{name:e.data().fullname,photoURL:e.data().photoURL,lastMessage:e.data().lastMessage,email:e.data().email,timeStamp:e.data().timeStamp})}))})]})};var w=function(e){var t=e.currentUser,n=e.signOut;return Object(g.jsx)("div",{className:"home",children:Object(g.jsxs)("div",{className:"home-container",children:[Object(g.jsx)(S,{currentUser:t,signOut:n}),Object(g.jsx)("div",{className:"home-bg",children:Object(g.jsx)("img",{src:"./WhatsAppbg.png",alt:""})})]})})},U=(n(36),n(34)),y=n.n(U),L=n(50),R=n.n(L),E=n(52),k=n.n(E),I=n(51),C=n.n(I),T=n(53),D=n.n(T),M=n(33),F=n.n(M);n(92);var _=function(e){var t=e.message,n=e.time,c=e.sender,s=e.translateFlag,r=e.chatUser,o=e.currentUser,u=e.messageFull,d=Object(a.useState)(t),j=Object(i.a)(d,2),m=j[0],f=j[1],h=(Object(l.g)().emailID,o.email===c),p=h?o.photoURL:r;return console.log(u),Object(a.useEffect)((function(){if(null!==s){var e=new URLSearchParams;e.append("q",m),e.append("source",s?"en":"ru"),e.append("target",s?"ru":"en"),e.append("api_key","xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"),F.a.post("https://libretranslate.de/translate",e,{headers:{accept:"application.json","Content-type":"application/x-www-form-urlencoded"}}).then((function(e){f(e.data.translatedText)}))}}),[s]),Object(g.jsxs)("div",{className:"chat-message",style:{alignSelf:h?"flex-end":"flex-start",alignItems:"left",backgroundColor:h?"rgb(64, 245, 101)":"#fff"},children:[Object(g.jsx)("img",{src:p,alt:"user",className:"img",style:{left:!h&&"-20px",right:h&&"-20px",top:"-18px"}}),Object(g.jsx)("div",{className:"chat-message-text",style:{color:h&&"#fff"},children:Object(g.jsx)("p",{children:m})}),Object(g.jsx)("div",{className:"chat-message-date",children:Object(g.jsx)("p",{children:new Date(n.toDate()).toLocaleTimeString()})})]})},P=n(49),A=n.n(P);var B=function(e){var t=e.currentUser,n=(e.setUnreadMessages,Object(a.useState)("")),c=Object(i.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(!1),u=Object(i.a)(o,2),m=u[0],f=u[1],p=Object(l.g)().emailID,b=Object(a.useState)({}),x=Object(i.a)(b,2),O=x[0],N=x[1],S=Object(a.useRef)(null),w=Object(a.useState)([]),U=Object(i.a)(w,2),L=U[0],E=U[1],I=Object(a.useState)(null),T=Object(i.a)(I,2),M=T[0],F=T[1];Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("users").doc(p).onSnapshot((function(e){N(e.data())}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.collection("chats").doc(p).collection("messages").orderBy("timeStamp","asc").onSnapshot((function(e){var n=e.docs.map((function(e){return e.data()})).filter((function(e){return e.senderEmail===(t.email||p)||e.receiverEmail===(t.email||p)}));E(n)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n()}),[p]),Object(a.useEffect)((function(){S.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})}))}),[L]);var P=function(){var e=Object(j.a)(d.a.mark((function e(n){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),p&&(a={text:s,senderEmail:t.email,receiverEmail:p,timeStamp:h.a.firestore.Timestamp.now(),isRead:!1},c={text:s,senderEmail:t.email,receiverEmail:p,timeStamp:h.a.firestore.Timestamp.now(),isRead:!1},v.collection("chats").doc(t.email).collection("messages").add(a),v.collection("chats").doc(p).collection("messages").add(c),v.collection("Friendlist").doc(t.email).collection("list").doc(p).set({email:O.email,fullname:O.fullname,photoURL:O.photoURL,lastMessage:s,timeStamp:h.a.firestore.Timestamp.now()}),v.collection("Friendlist").doc(p).collection("list").doc(t.email).set({email:t.email,fullname:t.fullname,photoURL:t.photoURL,lastMessage:s,timeStamp:h.a.firestore.Timestamp.now()}),r(""));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){v.collection("chats").doc(p).collection("messages").get().then((function(e){e.forEach((function(e){e.ref.update({isRead:!0})}))}))}),[p,L]),Object(g.jsxs)("div",{className:"chat-container",children:[Object(g.jsxs)("div",{className:"chat-container-header",children:[Object(g.jsxs)("div",{className:"chat-user-info",children:[Object(g.jsx)("p",{children:null===O||void 0===O?void 0:O.fullname}),(null===O||void 0===O?void 0:O.online)&&Object(g.jsx)("span",{children:"Active now"}),(null===O||void 0===O?void 0:O.online)&&Object(g.jsx)("div",{className:"active"})]}),Object(g.jsx)("div",{className:"chat-container-header-btn",children:Object(g.jsx)(y.a,{})})]}),Object(g.jsx)("div",{className:"chat-display-container",ref:S,children:L.map((function(e){return Object(g.jsx)(_,{message:e.text,time:e.timeStamp,sender:e.senderEmail,translateFlag:M,chatUser:O.photoURL,currentUser:t,messageFull:e})}))}),Object(g.jsxs)("div",{className:"chat-input",children:[m&&Object(g.jsx)(A.a,{onEmojiClick:function(e,t){return r(s+t.emoji)}}),Object(g.jsxs)("div",{className:"chat-input-btn",children:[Object(g.jsx)(R.a,{onClick:function(){return f(!m)}}),Object(g.jsx)(C.a,{}),Object(g.jsx)(k.a,{})]}),Object(g.jsx)("form",{onSubmit:P,children:Object(g.jsx)("input",{type:"text",placeholder:"Type a Message",value:s,onChange:function(e){r(e.target.value)}})}),Object(g.jsx)("div",{className:"select",children:Object(g.jsxs)("span",{onClick:function(){return F(null===M||!0===M&&!1||!1===M&&!0)},children:["Translate to ",M?"en":"ru"]})}),Object(g.jsx)("div",{className:"chat-input-send-btn",onClick:P,children:Object(g.jsx)(D.a,{})})]})]})};n(93);var J=function(e){var t=e.currentUser,n=e.signOut,c=Object(a.useState)(2),s=Object(i.a)(c,2),r=s[0],o=s[1];return Object(g.jsx)("div",{className:"chatpage",children:Object(g.jsxs)("div",{className:"chatpage-container",children:[Object(g.jsx)(S,{currentUser:t,signOut:n,unreadMessages:r}),Object(g.jsx)(B,{currentUser:t,setUnreadMessages:o})]})})};n(94);var K=function(e){var t=e.setUser,n=Object(l.f)();return Object(g.jsx)("div",{className:"login",children:Object(g.jsxs)("div",{className:"login-container",children:[Object(g.jsx)("img",{className:"login-logo",src:"./whatsapp-logo.png",alt:""}),Object(g.jsx)("h2",{className:"login_h2",children:"Welcome Back"}),Object(g.jsx)("p",{className:"login_p",children:" To keep connected with us please login with you personal info"}),Object(g.jsx)("button",{className:"login-btn",onClick:function(){b.signInWithPopup(O).then((function(e){var a={fullname:e.user.displayName,email:e.user.email,photoURL:e.user.photoURL,online:!0};n("/"),t(a),localStorage.setItem("user",JSON.stringify(a)),v.collection("users").doc(e.user.email).set(a)})).catch((function(e){return alert(e.message)}))},children:"SIGN IN"})]})})};var W=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("user"))),t=Object(i.a)(e,2),n=t[0],c=t[1],s=function(){b.signOut().then((function(){c(null),localStorage.removeItem("user"),v.collection("users").doc(n.email).set({email:n.email,fullname:n.fullname,photoURL:n.photoURL,online:!1})})).catch((function(e){return alert(e.message)}))};return Object(g.jsx)(o.a,{children:Object(g.jsx)("div",{className:"App",children:n?Object(g.jsxs)(l.c,{children:[Object(g.jsx)(l.a,{path:"/:emailID",element:Object(g.jsx)(J,{currentUser:n,signOut:s})}),Object(g.jsx)(l.a,{path:"/",element:Object(g.jsx)(w,{currentUser:n,signOut:s})})]}):Object(g.jsx)(K,{setUser:c})})})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(W,{})}),document.getElementById("root")),z()}},[[96,1,2]]]);
//# sourceMappingURL=main.44514f3d.chunk.js.map